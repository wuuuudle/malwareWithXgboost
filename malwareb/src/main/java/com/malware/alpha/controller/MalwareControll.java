package com.malware.alpha.controller;

import com.mashape.unirest.http.exceptions.UnirestException;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.multipart.MultipartFile;


import java.io.IOException;
import java.security.NoSuchAlgorithmException;

import static com.malware.alpha.domain.malware.getDetail;

@RestController
@RequestMapping("api")
public class MalwareControll {

    @PostMapping("upload")
    public String upload(@RequestParam("file") MultipartFile multipartFile) throws IOException, UnirestException, NoSuchAlgorithmException {
        var is = multipartFile.getInputStream();
        var result = getDetail(is);
        is.close();
        return result;
    }
}
