<template>
    <div class="back">
        <div class="band">
            <div class="banner_title">Malware Detection</div>
            <div class="banner_info">
                基于三层级联xgboost的恶意代码检测
            </div>
        </div>
        <div class="malBody">
            <el-upload drag
                       action="api/upload"
                       :on-success="success"
                       :before-upload="bload"
                       ref="child"
                       v-loading="loading">
                <el-image :src="require('../assets/thumbprint.png')"
                          style="height: 100px;margin-bottom: 10px"
                          fit="contain"/>
                <div class="el-upload__text">将文件拖到此处，或<em>点击上传</em></div>
            </el-upload>
            <el-row style="flex-grow: 1">
                <el-col :span="24">
                    <el-table :data="tableData" border style="width: 100%">
                        <el-table-column
                                prop="type"
                                label="type"
                                width="70"
                        />
                        <el-table-column
                                prop="value"
                                label="value"
                        />
                    </el-table>
                </el-col>
                <el-col :span="24">
                    <el-tooltip content="恶意代码的可能性">
                        <el-progress :percentage="properties"
                                     :text-inside="true"
                                     :stroke-width="20"
                                     :color="customColor"/>
                    </el-tooltip>
                </el-col>
            </el-row>
        </div>

    </div>
</template>

<script>
    export default {
        name: "index",
        data() {
            return {
                loading: false,
                tableData: [{
                    type: 'sha1',
                    value: ''
                }, {
                    type: 'sha256',
                    value: ''
                }, {
                    type: 'md5',
                    value: ''
                }],
                properties: 0
            }
        },
        methods: {
            success(response) {
                console.log(response);
                this.tableData = [];
                this.tableData.push({type: 'sha1', value: response['sha1']});
                this.tableData.push({type: 'sha256', value: response['sha256']});
                this.tableData.push({type: 'md5', value: response['md5']});
                this.properties = (response['positives'] / response['total'] * 100).toFixed(2);
                this.loading = false;
                this.$refs.child.clearFiles();
            },
            bload(file) {
                this.loading = true;
                console.log(file);
                return true;
            },
            customColor(percentage) {
                if (percentage < 33)
                    return '#5C887A';
                else if (percentage < 67)
                    return '#E6A23C';
                return '#F56C6C';
            }
        }
    }
</script>

<style scoped>
    .back {
        /*background-color: red;*/
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .band {
        background-image: url("../assets/malware.jpg");
        background-size: inherit;
        height: 500px;
        width: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .banner_title {
        padding-bottom: 24px;
        font-size: 48px;
        letter-spacing: 5px;
        color: white;
    }

    .banner_info {
        width: 500px;
        margin: 0 auto;
        padding-bottom: 24px;
        font-size: 16px;
        line-height: 28px;
        color: white;
    }

    .malBody {
        width: 80%;
        display: flex;
        margin: 10px;
    }
</style>